import pandas  as pd
import matplotlib.pyplot as plt
import folium
from folium import plugins

df_pedidos = pd.read_excel("/content/dataset_pedidos_delivery_PROJETO.xlsx")
df_pedidos.head(5)
df_pedidos.shape
df_pedidos.dtypes
df_pedidos.isnull().sum()
df_pedidos.hist(figsize=(20,10))

fig, ax_01 = plt.subplots()
df_pedidos.PRATO_PEDIDO.value_counts().plot(kind="bar", ax=ax_01)
ax_01.set_title("Nome dos pratos")
ax_01.set_ylabe("Quantidade de pratos vendida")

df_pratos_mais_faturam = df_pedidos.TOTAL_DA_COMPRA.groupby([df_pedidos.PRATO_PEDIDO])
df_pratos_mais_faturam.sum().sort_values(ascending=False)

df_maiores_vendas = df_pedidos[(df_pedidos["PRATO_PEDIDO"] == "SALADA_CAPRESE") |
(df_pedidos["PRATO_PEDIDO"] == "SALADA CAESAR") | (df_pedidos["PRATO_PEDIDO"] == "SALADA_FOLHAS_PARMA")]
df_maiores_vendas.head(5)
df_maiores_vendas.shape
df_maiores_vendas.PRATO_PEDIDO.value_counts()

local_maior_faturamento = df_maiores_vendas.TOTAL_DA_COMPRA.groupby([df_maiores_vendas.LATITUDE, df_maiores_vendas.LONGITUDE])
local_maior_faturamento.sum().sort_values(ascending=False)
mapa = folium.Map(location=[-23.5028441,-47.4335729], zoom_start=12)
mapa
latitude = df_maiores_vendas.LATITUDE.values
longitude = df_maiores_vendas.LONGITUDE.values
coordenadas = []
for lat,lon in zip(latitude,longitude): coordenadas.append([lat,lon])
mapa.add_child(plugins.HeatMap(coordenadas))

folium.Marker(location=[-23.495833,-47.429457],popup="Dark Kitchen", icon = folium.Icon(color="red"),).add_to(mapa)
mapa
